<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real-time Weather Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <style>
    :root{
      --glass: rgba(255,255,255,.18);
      --blur: 10px;
    }
    body{
      font-family: 'Kanit', sans-serif;
      transition: background 700ms ease, color 300ms ease;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      color: #fff;
    }
    .bg-sunny{
      background: radial-gradient(1200px 800px at 80% -10%, #FFE781 0%, rgba(255,231,129,0) 60%),
                  linear-gradient(135deg, #ffbdd4 0%, #ffd6a5 45%, #fff1b8 100%);
    }
    .bg-rain{
      background: linear-gradient(160deg, #1a2a6c 0%, #1e3c72 50%, #2a5298 100%);
    }
    .bg-cloudy{
      background: linear-gradient(120deg, #4b4b6b 0%, #6b5b73 50%, #7a6f86 100%);
    }
    .bg-night{
      background: radial-gradient(800px 600px at 70% -20%, rgba(148,187,233,.35) 0%, rgba(148,187,233,0) 60%),
                  linear-gradient(180deg, #0b1026 0%, #121a3b 60%, #1b2358 100%);
    }
    .fx-layer{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: -1;
      overflow: hidden;
    }
    .clouds{ opacity: .85; filter: drop-shadow(0 8px 12px rgba(0,0,0,.25)); }
    .cloud{
      position: absolute;
      width: var(--w, 220px);
      height: var(--h, 80px);
      background: rgba(255,255,255,.9);
      border-radius: 50px;
      animation: drift var(--speed, 80s) linear infinite;
    }
    .cloud:before, .cloud:after{
      content:"";
      position:absolute;
      background: rgba(255,255,255,.95);
      width:60%;
      height:120%;
      border-radius: 50%;
      top:-30%;
      left:10%;
      box-shadow: 80px 20px 0 10px rgba(255,255,255,.95);
    }
    @keyframes drift{
      0%{ transform: translateX(-30vw) translateY(var(--y,0)); }
      100%{ transform: translateX(130vw) translateY(var(--y,0)); }
    }
    .layer-1 .cloud{ --speed: 90s; opacity:.9; }
    .layer-2 .cloud{ --speed: 70s; opacity:.8; }
    .layer-3 .cloud{ --speed: 55s; opacity:.75; }
    .rain{
      position: fixed; inset:0;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.0) 0px,
        rgba(255,255,255,.0) 10px,
        rgba(255,255,255,.25) 11px,
        rgba(255,255,255,.25) 12px
      );
      mask-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%, #000 10%, #000 90%, rgba(0,0,0,0) 100%);
      animation: rainShift 700ms linear infinite;
      opacity: .55;
    }
    @keyframes rainShift{
      0%{ background-position: 0 0; }
      100%{ background-position: 0 40px; }
    }
    .raindrop{
      position:absolute;
      width:1px; height:60px;
      background: linear-gradient(to bottom, rgba(255,255,255,.0), rgba(255,255,255,.7));
      animation: fall var(--t, 1.2s) linear infinite;
      transform: translateZ(0);
      will-change: transform;
    }
    @keyframes fall{
      0%{ transform: translateY(-80px); opacity: 0; }
      10%{ opacity: 1; }
      100%{ transform: translateY(110vh); opacity: .2; }
    }
    .stars{
      position: fixed; inset:0;
      overflow:hidden;
    }
    .star{
      position:absolute;
      width:2px; height:2px;
      border-radius:50%;
      background: white;
      opacity:.9;
      animation: twinkle var(--tw, 2.5s) ease-in-out infinite alternate;
      box-shadow: 0 0 6px rgba(255,255,255,.9);
    }
    @keyframes twinkle{
      0%{ opacity:.3; transform: scale(1); }
      100%{ opacity:1; transform: scale(1.6); }
    }
    .card{
      backdrop-filter: blur(var(--blur));
      background-color: var(--glass);
      border-radius: 1.5rem;
      padding: 1.25rem;
      box-shadow: 0 10px 30px rgba(0,0,0,.2), inset 0 0 0 1px rgba(255,255,255,.12);
    }
    .temp-glow{
      text-shadow:
        0 0 12px rgba(255,255,255,.8),
        0 0 28px rgba(255,255,255,.5),
        0 0 54px rgba(255,255,200,.35);
      letter-spacing: 1px;
    }
    .icon-glow{
      filter: drop-shadow(0 0 10px rgba(255,255,255,.6));
    }
  </style>
</head>
<body class="bg-sunny text-white p-4 flex flex-col justify-center items-center">
  <div class="fx-layer stars" id="starsLayer" style="display:none;"></div>
  <div class="fx-layer clouds" id="cloudsLayer" style="display:none;">
    <div class="layer-1"></div>
    <div class="layer-2"></div>
    <div class="layer-3"></div>
  </div>
  <div class="fx-layer rain" id="rainLayer" style="display:none"></div>
  <div class="fx-layer" id="rainDropsLayer" style="display:none"></div>

  <div class="max-w-xl w-full mx-auto space-y-6 relative z-10">
    <div class="flex flex-col items-center text-center pt-8 pb-4">
      <div class="flex items-center gap-3">
        <span id="main-icon" class="text-5xl icon-glow">‚Äî</span>
        <h1 class="text-3xl md:text-4xl font-semibold mt-2" id="city-name">‚Äî</h1>
      </div>
      <div class="flex items-center mt-3">
        <span class="text-7xl md:text-8xl font-extralight temp-glow leading-none" id="temp-value">--¬∞C</span>
      </div>
      <p class="text-2xl opacity-95 mt-1 capitalize" id="weather-description">...</p>
      <div class="flex space-x-4 mt-2 opacity-90">
        <p class="text-lg"><span id="temp-max-value">--</span>¬∞C (Max)</p>
        <p class="text-lg"><span id="temp-min-value">--</span>¬∞C (Min)</p>
      </div>
    </div>
    <!-- Rest of the cards remain the same -->
    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üíß Humidity</p>
        <p class="text-2xl font-medium mt-1" id="humidity-value">--%</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üå°Ô∏è Pressure</p>
        <p class="text-2xl font-medium mt-1"><span id="pressure-value">--</span> hPa</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üå¨Ô∏è Wind Speed</p>
        <p class="text-2xl font-medium mt-1"><span id="wind-speed-value">--</span> m/s</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üß≠ Wind Direction</p>
        <p class="text-2xl font-medium mt-1"><span id="wind-direction-value">--</span>¬∞</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">‚òÄÔ∏è UV Index</p>
        <p class="text-2xl font-medium mt-1" id="uv-index-value">--</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üå°Ô∏è Feels Like</p>
        <p class="text-2xl font-medium mt-1" id="feels-like-value">--¬∞C</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üåÖ Sunrise</p>
        <p class="text-2xl font-medium mt-1" id="sunrise-value">--</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üåá Sunset</p>
        <p class="text-2xl font-medium mt-1" id="sunset-value">--</p>
      </div>
      <div class="card flex flex-col items-center text-center">
        <p class="text-sm opacity-80">üëÅÔ∏è Visibility</p>
        <p class="text-2xl font-medium mt-1"><span id="visibility-value">--</span> km</p>
      </div>
    </div>
  </div>

  <script>
    const API_KEY = 'ccffd32214c3b336e740cd6b4c9cf5d0';
    const cityName = 'Bangkok, Thailand'; // ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô input ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    const cloudsLayer = document.getElementById('cloudsLayer');
    const rainLayer = document.getElementById('rainLayer');
    const rainDropsLayer = document.getElementById('rainDropsLayer');
    const starsLayer = document.getElementById('starsLayer');
    const mainIconEl = document.getElementById('main-icon');
    const cityNameEl = document.getElementById('city-name');

    async function getCoordinates(city){
      const url = `https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=1&appid=${API_KEY}`;
      const res = await fetch(url);
      const data = await res.json();
      if(data.length) return {lat: data[0].lat, lon: data[0].lon, name: data[0].name};
      throw new Error('City not found');
    }

    async function fetchWeatherByCity(city){
      try{
        const {lat, lon, name} = await getCoordinates(city);
        cityNameEl.textContent = name;
        const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
        const currentUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
        const uvUrl = `https://api.openweathermap.org/data/2.5/uvi?lat=${lat}&lon=${lon}&appid=${API_KEY}`;
        const [forecastRes, currentRes, uvRes] = await Promise.all([fetch(forecastUrl), fetch(currentUrl), fetch(uvUrl)]);
        const forecastData = await forecastRes.json();
        const currentData = await currentRes.json();
        let uvData = { value: '--' };
        if(uvRes.ok) uvData = await uvRes.json();
        displayCurrentWeather(currentData, forecastData, uvData);
        displayHourlyForecast(forecastData.list);
        displayDailyForecast(forecastData.list);
        const wId = currentData.weather?.[0]?.id ?? 800;
        const night = isNightBySys(currentData.sys);
        const theme = classifyWeather(wId);
        mainIconEl.textContent = getWeatherIcon(wId);
        updateFX(theme, night);
      }catch(err){
        console.error(err);
      }
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö displayCurrentWeather, displayHourlyForecast, displayDailyForecast, FX etc.
    // ... (copy ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏°‡∏µ displayCurrentWeather, displayHourlyForecast, displayDailyForecast, updateFX etc.)

    fetchWeatherByCity(cityName);
  </script>
</body>
</html>
